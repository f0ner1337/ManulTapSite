<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>–ö–ª–∏–∫–µ—Ä –ú–∞–Ω—É–ª</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="container">
        <div id="counter">0 ManulCoin</div>
        <img src="img/manul.jpg" alt="–ú–∞–Ω—É–ª" id="manul">
        <div id="energy-container">
            <div id="energy-bar-container">
                <div id="energy-bar">5000/5000‚ö°</div>
            </div>
        </div>
        <div id="upgrade-container">
            <div id="upgrade-info">–£—Ä–æ–≤–µ–Ω—å –ø—Ä–æ–∫–∞—á–∫–∏üìà: <span id="upgrade-level">1</span></div>
            <button id="upgrade-button">–ü—Ä–æ–∫–∞—á–∞—Ç—å —Å–∏–ª—É –∫–ª–∏–∫–∞üñ±Ô∏è</button>
        </div>
        <div id="level-info">
            <div>–£—Ä–æ–≤–µ–Ω—å –ø–µ—Ä—Å–æ–Ω–∞–∂–∞üéÆ: <span id="player-level">1</span></div>
            <div>–°–ª–µ–¥—É—é—â–∏–π —É—Ä–æ–≤–µ–Ω—åüöÄ: <span id="next-level-requirement">5000</span> ManulCoinüêæ</div>
        </div>
    </div>
    <script>
        const manul = document.getElementById('manul');
        const counter = document.getElementById('counter');
        const energyBar = document.getElementById('energy-bar');
        const upgradeButton = document.getElementById('upgrade-button');
        const upgradeLevelSpan = document.getElementById('upgrade-level');
        const playerLevelSpan = document.getElementById('player-level');
        const nextLevelRequirementSpan = document.getElementById('next-level-requirement');

        let energy = parseFloat(localStorage.getItem('energy')) || 5000; // –ù–∞—á–∞–ª—å–Ω–∞—è —ç–Ω–µ—Ä–≥–∏—è
        let clicks = parseInt(localStorage.getItem('clicks')) || 0; // –ù–∞—á–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∏–∫–æ–≤
        let upgradeLevel = parseInt(localStorage.getItem('upgradeLevel')) || 1; // –ù–∞—á–∞–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å –ø—Ä–æ–∫–∞—á–∫–∏
        let playerLevel = parseInt(localStorage.getItem('playerLevel')) || 1; // –ù–∞—á–∞–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å –ø–µ—Ä—Å–æ–Ω–∞–∂–∞

        // –£—Ä–æ–≤–Ω–∏ –∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
        const levelRequirements = [
            { level: 2, clicks: 5000, energy: 7500 },
            { level: 3, clicks: 10000, energy: 10000 },
            { level: 4, clicks: 15000, energy: 12500 },
            { level: 5, clicks: 30000, energy: 25000 },
            { level: 6, clicks: 50000, energy: 45000 },
            { level: 7, clicks: 100000, energy: 50000 },
            { level: 8, clicks: 250000, energy: 50000 },
            { level: 9, clicks: 500000, energy: 50000 },
            { level: 10, clicks: 1000000, energy: 50000 }
        ];

        function getNextLevelRequirement() {
            const nextLevel = levelRequirements.find(req => req.level === playerLevel + 1);
            return nextLevel ? nextLevel.clicks : 'MAX';
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —ç–Ω–µ—Ä–≥–∏–∏ –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞
        function updateEnergy() {
            const lastUpdateTime = parseFloat(localStorage.getItem('lastUpdateTime')) || Date.now();
            const now = Date.now();
            const secondsElapsed = (now - lastUpdateTime) / 1000;

            if (energy < getMaxEnergy()) {
                energy += 0.5 * secondsElapsed; // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —ç–Ω–µ—Ä–≥–∏–∏
                if (energy > getMaxEnergy()) {
                    energy = getMaxEnergy(); // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —ç–Ω–µ—Ä–≥–∏–∏
                }
                localStorage.setItem('energy', energy);
                energyBar.textContent = `${Math.floor(energy)}/${getMaxEnergy()}‚ö°`;
                energyBar.style.width = `${(energy / getMaxEnergy()) * 100}%`;
            }

            localStorage.setItem('lastUpdateTime', now); // –û–±–Ω–æ–≤–ª—è–µ–º –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
        }

        function getMaxEnergy() {
            const currentLevel = levelRequirements.find(req => req.level === playerLevel);
            return currentLevel ? currentLevel.energy : 5000;
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–∞
        manul.addEventListener('click', (event) => {
            if (energy > 0) {
                let clickValue = upgradeLevel; // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∞–Ω—É–ª–æ–≤ –∑–∞ –∫–ª–∏–∫
                energy -= clickValue; // –†–∞—Å—Ö–æ–¥ —ç–Ω–µ—Ä–≥–∏–∏
                clicks += clickValue;
                localStorage.setItem('clicks', clicks);
                localStorage.setItem('energy', energy);
                counter.textContent = clicks;
                energyBar.textContent = `${Math.floor(energy)}/${getMaxEnergy()}‚ö°`;
                energyBar.style.width = `${(energy / getMaxEnergy()) * 100}%`;

                // –°–æ–∑–¥–∞–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞ +X –ø—Ä–∏ –∫–ª–∏–∫–µ
                const plusOne = document.createElement('div');
                plusOne.textContent = `+${clickValue}`;
                plusOne.className = 'plus-one';
                plusOne.style.left = `${event.clientX - container.offsetLeft}px`;
                plusOne.style.top = `${event.clientY - container.offsetTop}px`;
                container.appendChild(plusOne);

                // –£–¥–∞–ª–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞ +X –ø–æ—Å–ª–µ –∞–Ω–∏–º–∞—Ü–∏–∏
                setTimeout(() => {
                    container.removeChild(plusOne);
                }, 1000);

                // –ê–Ω–∏–º–∞—Ü–∏—è —É–≤–µ–ª–∏—á–µ–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –º–∞–Ω—É–ª–∞
                manul.classList.add('clicked');
                setTimeout(() => {
                    manul.classList.remove('clicked');
                }, 100);

                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø–æ–≤—ã—à–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è
                checkLevelUp();
            }
        });

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è –ø—Ä–æ–∫–∞—á–∫–∏
        upgradeButton.addEventListener('click', () => {
            if (clicks >= 100 * upgradeLevel) {
                clicks -= 100 * upgradeLevel;
                upgradeLevel++;
                localStorage.setItem('clicks', clicks);
                localStorage.setItem('upgradeLevel', upgradeLevel);
                upgradeLevelSpan.textContent = upgradeLevel;
                counter.textContent = clicks;
                energy = Math.max(0, energy - (upgradeLevel - 1)); // –†–∞—Å—Ö–æ–¥ —ç–Ω–µ—Ä–≥–∏–∏ –ø—Ä–∏ –ø—Ä–æ–∫–∞—á–∫–µ
                localStorage.setItem('energy', energy);
                energyBar.textContent = `${Math.floor(energy)}/${getMaxEnergy()}‚ö°`;
                energyBar.style.width = `${(energy / getMaxEnergy()) * 100}%`;
            }
        });

        function checkLevelUp() {
            const nextLevel = levelRequirements.find(req => req.level === playerLevel + 1);
            if (nextLevel && clicks >= nextLevel.clicks) {
                playerLevel = nextLevel.level;
                energy = nextLevel.energy;
                localStorage.setItem('playerLevel', playerLevel);
                localStorage.setItem('energy', energy);
                energyBar.textContent = `${Math.floor(energy)}/${getMaxEnergy()}‚ö°`;
                energyBar.style.width = `${(energy / getMaxEnergy()) * 100}%`;
                playerLevelSpan.textContent = playerLevel;
                nextLevelRequirementSpan.textContent = getNextLevelRequirement();
            }
        }

        // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —ç–Ω–µ—Ä–≥–∏—é –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É
        setInterval(updateEnergy, 1000);

        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
        upgradeLevelSpan.textContent = upgradeLevel;
        playerLevelSpan.textContent = playerLevel;
        nextLevelRequirementSpan.textContent = getNextLevelRequirement();
        energyBar.textContent = `${Math.floor(energy)}/${getMaxEnergy()}‚ö°`;
        energyBar.style.width = `${(energy / getMaxEnergy()) * 100}%`;
        counter.textContent = clicks;
    </script>
</body>
</html>
